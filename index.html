<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ãŠç¥­ã‚Šã‚¬ãƒ©ã‚¬ãƒ©æŠ½é¸</title>
<style>
:root{
  --bg1:#fff7d6; --bg2:#ffe39a;
  --red:#e53935; --gold:#d4af37;
}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Hiragino Kaku Gothic ProN","Noto Sans JP",sans-serif;
  background:radial-gradient(circle,var(--bg1),var(--bg2));
  color:#222;
}
.card{
  max-width:430px;
  margin:24px auto;
  background:#fff;
  border-radius:22px;
  padding:18px 18px 22px;
  box-shadow:0 20px 60px rgba(0,0,0,.18);
  text-align:center;
}
h1{
  margin:6px 0 4px;
  color:var(--red);
  font-size:30px;
  letter-spacing:.02em;
}
.sub{margin:0 0 14px;color:#666}

.stage{
  background:linear-gradient(180deg,#fff,#fff7f7);
  border:2px solid rgba(229,57,53,.18);
  border-radius:18px;
  padding:18px 14px 16px;
}
.machine{
  width:280px;
  height:280px;
  margin:0 auto;
  position:relative;
}
.glass{
  position:absolute; inset:18px;
  border-radius:50%;
  background:radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.20));
  border:8px solid rgba(229,57,53,.25);
  box-shadow:inset 0 0 30px rgba(0,0,0,.08);
  z-index:3;
}
/* ä¸­ã®èµ¤ç™½å›è»¢ç›¤ï¼ˆè¦‹ãˆã‚‹å›è»¢ãƒ©ã‚¤ãƒ³ï¼‰ */
.wheel{
  position:absolute;
  inset:36px;
  border-radius:50%;
  z-index:2;
  background:
    repeating-conic-gradient(
      from 0deg,
      #ffffff 0 18deg,
      #ffffff 18deg 30deg,
      #ff3b30 30deg 48deg,
      #ff3b30 48deg 60deg
    );
  filter:saturate(1.1);
  box-shadow:0 10px 30px rgba(0,0,0,.12);
}
.wheel::after{
  content:"";
  position:absolute; inset:18px;
  border-radius:50%;
  background:radial-gradient(circle,#fff,rgba(255,255,255,.2));
  border:2px solid rgba(0,0,0,.05);
}
/* å¤–æ ãƒªãƒ³ã‚° */
.ring{
  position:absolute; inset:10px;
  border-radius:50%;
  border:10px solid rgba(242,166,90,.55);
  box-shadow:0 12px 35px rgba(0,0,0,.12);
  z-index:1;
}
/* ãƒãƒ³ãƒ‰ãƒ« */
.handle{
  position:absolute;
  right:-6px; top:104px;
  width:26px; height:92px;
  background:var(--red);
  border-radius:14px;
  z-index:4;
  box-shadow:0 10px 25px rgba(0,0,0,.18);
}
.handle::before{
  content:"";
  position:absolute;
  top:-20px; left:50%;
  transform:translateX(-50%);
  width:56px; height:56px;
  border-radius:50%;
  background:radial-gradient(circle at 35% 35%, #fff, #ffd9d9);
  border:3px solid rgba(229,57,53,.25);
}
/* å›è»¢ã‚¢ãƒ‹ãƒ¡ï¼ˆã‚¬ãƒ©ã‚¬ãƒ©æ„Ÿå¼·ã‚ï¼‰ */
.spin .wheel{
  animation:spinFast .18s linear infinite;
}
@keyframes spinFast{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}

/* ã‚­ãƒ©ã‚­ãƒ©ï¼ˆå›ã—ã¦ã‚‹æœ€ä¸­ã ã‘è¡¨ç¤ºï¼‰ */
.sparkle{
  position:absolute; inset:0;
  pointer-events:none;
  z-index:5;
  opacity:0;
}
.spin .sparkle{opacity:1; animation:twinkle .6s ease-in-out infinite;}
@keyframes twinkle{
  0%,100%{filter:drop-shadow(0 0 0 rgba(255,215,0,.0))}
  50%{filter:drop-shadow(0 0 14px rgba(255,215,0,.55))}
}
.sparkle span{
  position:absolute;
  font-size:18px;
}
.sparkle span:nth-child(1){left:18px; top:26px}
.sparkle span:nth-child(2){left:34px; bottom:30px}
.sparkle span:nth-child(3){right:34px; top:34px}
.sparkle span:nth-child(4){right:26px; bottom:34px}
.sparkle span:nth-child(5){left:50%; top:10px; transform:translateX(-50%)}
.sparkle span:nth-child(6){left:50%; bottom:8px; transform:translateX(-50%)}

button{
  width:100%;
  margin-top:14px;
  padding:16px 14px;
  font-size:22px;
  font-weight:800;
  background:var(--red);
  color:#fff;
  border:none;
  border-radius:16px;
  box-shadow:0 14px 30px rgba(229,57,53,.28);
}
button:disabled{opacity:.6}
.note{
  margin-top:10px;
  color:#666;
  font-size:12px;
}
</style>
</head>
<body>
  <div class="card">
    <h1>ğŸ¯ ã‚¬ãƒ©ã‚¬ãƒ©æŠ½é¸ ğŸ¯</h1>
    <p class="sub">ã‚¿ãƒƒãƒã—ã¦ã‚¬ãƒ©ã‚¬ãƒ©å›ã—ã¦ã­ï¼</p>

    <div class="stage" id="stage">
      <div class="machine" aria-label="ã‚¬ãƒ©ã‚¬ãƒ©æœ¬ä½“">
        <div class="ring"></div>
        <div class="wheel" id="wheel"></div>
        <div class="glass"></div>
        <div class="handle"></div>

        <div class="sparkle" aria-hidden="true">
          <span>âœ¨</span><span>âœ¨</span><span>âœ¨</span>
          <span>âœ¨</span><span>âœ¨</span><span>âœ¨</span>
        </div>
      </div>

      <button id="btn">ã‚¿ãƒƒãƒã—ã¦å›ã™</button>
      <div class="note">â€»çµæœç”»é¢ã‚’ã‚¹ã‚¿ãƒƒãƒ•ã«ãŠè¦‹ã›ãã ã•ã„</div>
    </div>
  </div>

<script>
const btn = document.getElementById("btn");
const stage = document.getElementById("stage");

function drawGrade(){
  // æŒ‡å®šç¢ºç‡ï¼šç™½(3ç­‰)98%ã€èµ¤(2ç­‰)0.15%ã€é‡‘(1ç­‰)0.05%
  const r = Math.random()*100;
  if(r < 0.05) return "1";         // 0.05%
  if(r < 0.20) return "2";         // 0.15%ï¼ˆ0.05ã€œ0.20ï¼‰
  return "3";                      // 99.8%â€¦ã«è¦‹ãˆã‚‹ã®ã§ 98%ã«ã—ãŸã„å ´åˆã¯ä¸‹ã‚’èª¿æ•´
}

// â†‘ã€Œ3ç­‰98%ã€å³å¯†ã«ã—ãŸã„ãªã‚‰ã“ã‚Œã«ç½®ãæ›ãˆï¼š
//  const r = Math.random()*100;
//  if(r < 0.05) return "1";        // 0.05
//  if(r < 0.20) return "2";        // 0.15
//  if(r < 98.20) return "3";       // 98.00
//  return "3";                     // æ®‹ã‚Šã‚‚3ç­‰æ‰±ã„ï¼ˆå®Ÿè³ª98%+ï¼‰

btn.addEventListener("click", ()=>{
  btn.disabled = true;
  stage.classList.add("spin");

  // â€œå›ã—ã¦ã‚‹æ™‚é–“â€ã‚’å›ºå®šï¼ˆãƒ¯ã‚¯ãƒ¯ã‚¯ï¼‰
  setTimeout(()=>{
    stage.classList.remove("spin");

    const grade = drawGrade();
    // result.html ã«é·ç§»ï¼ˆç”»é¢åˆ‡ã‚Šæ›¿ãˆï¼‰
    location.href = `result.html?g=${grade}&t=${Date.now()}`;
  }, 2500);
});
</script>
</body>
</html>
